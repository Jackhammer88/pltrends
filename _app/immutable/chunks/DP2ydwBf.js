import{g as c,w as i}from"./IDmWtmY4.js";import"./BPQSsSeE.js";const l="https://bbaii2i41d3ecpiaumro.containers.yandexcloud.net/api/v1";class r{constructor(t,e){this.Code=t,this.Description=e}}async function p(){const n=c(u);console.log(n);const t={"Content-Type":"application/json"};n&&(t["X-Authorization"]=`Bearer ${n.AccessToken}`);const e=await fetch(`${l}/data/langs`,{method:"GET",headers:t});if(!e.ok){const o=await e.text();return new r(e.status,o||"Unknown error")}try{return(await e.json()).langs}catch{return new r(500,"Invalid JSON from server")}}async function g(n){const t=c(u),e={"Content-Type":"application/json"};t&&(e["X-Authorization"]=`Bearer ${t.AccessToken}`);const o=await fetch(`${l}/data/lang?lang=${encodeURIComponent(n)}`,{method:"GET",headers:e});if(!o.ok){const s=await o.text();return new r(o.status,s||"Unknown error")}try{const s=await o.blob();return await new Promise((f,h)=>{const a=new FileReader;a.onloadend=()=>f(a.result),a.onerror=h,a.readAsDataURL(s)})}catch{return new r(500,"Invalid JSON from server")}}class y{constructor(t,e){this.AccessToken=t,this.ExpiresIn=e}}async function x(n){c(u);const t=await fetch(`${l}/auth/exchange`,{method:"POST",body:JSON.stringify({code:n})});if(!t.ok){const e=await t.text();return new r(t.status,e||"Unknown error")}try{const e=await t.json();return new y(e.access_token,e.expires_in)}catch{return new r(500,"Invalid JSON from server")}}const u=i(null),d=i([]),w=i({});async function A(){let n=!1;if(d.update(e=>(n=e.length>0,e)),n)return;let t=await p();Array.isArray(t)?d.set(t):console.error("API error:",t.Code,t.Description)}async function T(n){const t=c(w);if(t[n])return t[n];const e=await g(n);return typeof e=="string"?(w.update(o=>({...o,[n]:e})),e):(console.error("Failed to load lang stats:",e),null)}export{l as B,y as T,d as a,T as b,x as e,u as g,A as l};
